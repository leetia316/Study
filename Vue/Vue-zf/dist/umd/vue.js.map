{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/utils.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parse.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/index.js","../../src/index.js"],"sourcesContent":["// 获取数组原型上的方法\r\nlet oldArrayProtoMethods = Array.prototype\r\n\r\n// 继承方法\r\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\r\n\r\nlet methods = [\r\n  'push',\r\n  'pop',\r\n  'shift',\r\n  'unshift',\r\n  'reverse',\r\n  'sort',\r\n  'split'\r\n]\r\n\r\nmethods.forEach(methods => {\r\n  arrayMethods[methods] = function (...args) {\r\n    console.log('数组方法被调用了')\r\n    const result = oldArrayProtoMethods[methods].apply(this, args)\r\n    let inserted\r\n    let ob = this.__ob__\r\n\r\n    switch (methods) {\r\n    case 'push':\r\n    case 'unshift':\r\n      inserted = args\r\n      break\r\n    case 'slice':\r\n      inserted = args.slice(2)\r\n      break\r\n    default: break\r\n    }\r\n\r\n    if (inserted) ob.observeArray(inserted)\r\n\r\n    return result\r\n  }\r\n})","export function proxy(vm, data, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[data][key]\r\n    },\r\n    set(newValue) {\r\n      vm[data][key] = newValue\r\n    }\r\n  })\r\n}\r\n\r\nexport function defineProperty(target, key, value) {\r\n  Object.defineProperty(target, key, {\r\n    enumerable: false,\r\n    configurable: false,\r\n    value\r\n  })\r\n}","import { arrayMethods } from './array'\r\nimport { defineProperty } from '../utils'\r\n\r\n/**\r\n * 劫持对象\r\n * @param {object} data\r\n * @param {*} key\r\n * @param {*} value\r\n */\r\nfunction defineReactive(data, key, value) {\r\n  observe(value) // 递归劫持\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      console.log('用户获取值了')\r\n      return value\r\n    },\r\n    set(newValue) {\r\n      if (newValue == value) return\r\n      observe(newValue) // 如果新值是个对象也要拦截\r\n      value = newValue\r\n      console.log('用户设置值了')\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 封装对属性进行观测的类\r\n */\r\nclass Observer {\r\n  constructor(value) {\r\n    // 判断一个对象是否被观测过可以查看有没有没 __ob__\r\n    defineProperty(value, '__ob__', this)\r\n\r\n    // 使用 defineProperty 重新定义属性\r\n    if (Array.isArray(value)) { // 数组函数劫持(切片编程)\r\n      Object.setPrototypeOf(value, arrayMethods)\r\n      this.observeArray(value) // 观测数组中的对象类型\r\n    } else { // 对象属性劫持\r\n      this.walk(value)\r\n    }\r\n  }\r\n  observeArray(value) {\r\n    value.forEach(item => observe(item))\r\n  }\r\n  walk(data) {\r\n    let keys = Object.keys(data)\r\n    keys.forEach(key => {\r\n      // 定义成响应数据\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n}\r\n\r\nexport function observe(data) {\r\n  if (typeof data !== 'object' && data !== null) { // 确保必须是对象\r\n    return data\r\n  }\r\n  if (data.__ob__) {\r\n    return data\r\n  }\r\n  return new Observer(data)\r\n}","import { observe } from './observer/index'\r\nimport { proxy } from './utils'\r\n\r\nfunction initProps() {}\r\nfunction initMethods() {}\r\nfunction initData(vm) {\r\n  let data = vm.$options.data\r\n  vm._data = data = typeof data == 'function' ? data.call(vm) : data\r\n\r\n  // 将data的属性代理到vm上\r\n  for (let key in data) {\r\n    proxy(vm, '_data', key)\r\n  }\r\n\r\n  // 数据的劫持方案 Object.defineProperty 对象处理\r\n  observe(data)\r\n}\r\nfunction initComputed() {}\r\nfunction initWatch() {}\r\n\r\n/**\r\n * 初始化状态 - 数据劫持\r\n * @param {object} vm - Vue实例\r\n */\r\nexport function initState(vm) {\r\n  const opts = vm.$options\r\n  if (opts.props) {\r\n    initProps(vm)\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm)\r\n  }\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n  if (opts.computed) {\r\n    initComputed(vm)\r\n  }\r\n  if (opts.watch) {\r\n    initWatch(vm)\r\n  }\r\n}\r\n","/* eslint-disable no-useless-escape */\r\nconst ncname = '[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*'\r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`) // 标签开头的正则 捕获的内容是标签名\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`) // 匹配标签结尾的 </div>\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/ // 匹配属性的\r\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\r\n\r\n/**\r\n * 解析HTML为抽象语法树(AST)\r\n * @param {string} html\r\n */\r\nexport function parseHTML(html) {\r\n  function createASTElement(tagName, attrs) {\r\n    return {\r\n      tag: tagName,\r\n      type: 1,\r\n      children: [],\r\n      attrs,\r\n      parent: null\r\n    }\r\n  }\r\n\r\n  let root\r\n  let currentParent\r\n  let stack = []\r\n  function start(tagName, attrs) {\r\n    let element = createASTElement(tagName, attrs)\r\n    if (!root) {\r\n      root = element\r\n    }\r\n    currentParent = element // 保存当前解析的标签\r\n    stack.push(element) // 将生成的ast元素放到栈中\r\n  }\r\n  function end(tagName) {\r\n    let element = stack.pop() // 取出栈中的最后一个\r\n    currentParent = stack[stack.length - 1]\r\n    if (currentParent) { // 在闭合时可以知道该标签的父节点\r\n      // 解决ast父子关系\r\n      element.parent = currentParent\r\n      currentParent.children.push(element)\r\n    }\r\n  }\r\n  function chars(text) {\r\n    // text = text.replace(/\\s/g, '') // 删除空字符串\r\n    if (text) {\r\n      currentParent.children.push({\r\n        type: 3,\r\n        text\r\n      })\r\n    }\r\n  }\r\n\r\n  while (html) {\r\n    let textEnd = html.indexOf('<')\r\n    if (textEnd == 0) { // 处理标签\r\n      const startTagMatch = parseStartTag() // 开始标签匹配的结果\r\n      if (startTagMatch) {\r\n        start(startTagMatch.tagName, startTagMatch.attrs)\r\n        continue\r\n      }\r\n      const endTagMatch = html.match(endTag)\r\n      if (endTagMatch) {\r\n        advance(endTagMatch[0].length)\r\n        end(endTagMatch[1]) // 将结束标签传入\r\n        continue\r\n      }\r\n    }\r\n    let text\r\n    if (textEnd > 0) { // 处理文本\r\n      // 截取文本\r\n      text = html.substring(0, textEnd)\r\n    }\r\n    if (text) {\r\n      advance(text.length)\r\n      chars(text)\r\n    }\r\n  }\r\n  function advance(n) { // 截取剩余字符串\r\n    html = html.substring(n)\r\n  }\r\n  function parseStartTag() { // 解析标签头\r\n    const start = html.match(startTagOpen)\r\n    if (start) {\r\n      const match = {\r\n        tagName: start[1],\r\n        attrs: []\r\n      }\r\n      advance(start[0].length) // 删除开始标签\r\n      let end\r\n      let attr\r\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n        match.attrs.push({\r\n          name: attr[1],\r\n          value: attr[3] || attr[4] || attr[5]\r\n        })\r\n        advance(attr[0].length)\r\n      }\r\n      if (end) {\r\n        advance(end[0].length)\r\n        return match\r\n      }\r\n    }\r\n  }\r\n\r\n  return root\r\n}\r\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n// FROM: <div id=\"app\" style=\"color:red\"> hello {{name}} <span>hello</span></div>\r\n\r\n// TO: render() {\r\n//   return _c('div', {id: 'app', style: {color: 'red'}}, _v('hello' + _s(name)), _c('span', null, _v('hello')))\r\n// }\r\n\r\n/**\r\n * 解析标签属性\r\n * @param {object} attrs\r\n */\r\nfunction genProps(attrs) {\r\n  let str = ''\r\n  for (let i = 0; i < attrs.length; i++) {\r\n    let attr = attrs[i]\r\n    if (attr.name === 'style') {\r\n      let obj = {}\r\n      attr.value.split(';').forEach(item => {\r\n        let [key, value] = item.split(':')\r\n        obj[key] = value\r\n      })\r\n      attr.value = obj\r\n    }\r\n    str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n  }\r\n  return `{${str.slice(0, -1)}}`\r\n}\r\n\r\n/**\r\n * 解析子节点\r\n * @param {object} node - 子节点\r\n */\r\nfunction gen(node) {\r\n  if (node.type == 1) { // 如果是元素节点\r\n    return generate(node)\r\n  }\r\n  let text = node.text // 获取文本\r\n  // 如果是普通文本 不带{{}}\r\n  if (!defaultTagRE.test(text)) {\r\n    return `_v(${JSON.stringify(text)})`\r\n  }\r\n  let tokens = []\r\n  let lastIndex = defaultTagRE.lastIndex = 0 // 重置正则匹配\r\n  let match, index\r\n\r\n  while (match = defaultTagRE.exec(text)) {\r\n    index = match.index\r\n    if (index > lastIndex) {\r\n      tokens.push(JSON.stringify(text.slice(lastIndex, index)))\r\n    }\r\n    tokens.push(`_s(${match[1].trim()})`)\r\n    lastIndex = index + match[0].length\r\n  }\r\n  if (lastIndex < text.length) {\r\n    tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n  }\r\n  return `_v(${tokens.join('+')})`\r\n}\r\n\r\n/**\r\n * 拼接子节点\r\n * @param {object} el - ASTNode\r\n */\r\nfunction genChildren(el) {\r\n  const children = el.children\r\n  if (children) { // 将所有转化后的子节点用逗号拼接\r\n    return children.map(child => gen(child)).join(',')\r\n  }\r\n}\r\n\r\n/**\r\n * 解析AST为render返回值\r\n * @param {object} el - ASTNode\r\n */\r\nexport function generate(el) {\r\n  let children = genChildren(el) // 子节点的生成\r\n  let code = `_c('${el.tag}', ${\r\n    el.attrs.length ? `${genProps(el.attrs)}` : 'undefined'\r\n  }${\r\n    children ? `,${children}`: ''\r\n  })`\r\n\r\n  return code\r\n}","import { parseHTML } from './parse'\r\nimport { generate } from './generate'\r\n\r\n/**\r\n * 将HTML模板解析成render函数\r\n * @param {*} template - HTML模板\r\n */\r\nexport function compileToFunctions(template) {\r\n  // 将模板解析成ast树\r\n  let ast = parseHTML(template)\r\n  // 1. 通过ast生成代码\r\n\r\n  // 2. 优化静态节点\r\n\r\n  // 3. 通过AST树 生成代码\r\n  let code = generate(ast)\r\n\r\n  //4 . 将字符串变成函数\r\n  let render = new Function(`with (this) { return ${code} }`)\r\n  return render\r\n}\r\n","export function patch(oldVnode, vnode) {\r\n  // 将虚拟节点转化成真实节点\r\n  let el = createElm(vnode)\r\n  let parentElm = oldVnode.parentNode\r\n  parentElm.insertBefore(el, oldVnode.nextSibling)\r\n  parentElm.removeChild(oldVnode)\r\n}\r\n\r\n/**\r\n * 根据虚拟dom创建真实节点\r\n * @param {object} vnode - 虚拟dom\r\n */\r\nfunction createElm(vnode) {\r\n  let {tag, children, key, data, text} = vnode\r\n  if (typeof tag == 'string') {\r\n    vnode.el = document.createElement(tag)\r\n    children.forEach(child => {\r\n      vnode.el.appendChild(createElm(child))\r\n    })\r\n  } else {\r\n    vnode.el = document.createTextNode(text)\r\n  }\r\n  return vnode.el\r\n}","import { patch } from './vdom/patch'\r\n\r\n/**\r\n * Vue生命周期扩展\r\n * @param {object} Vue - Vue 实例\r\n */\r\nexport function lifecycleMixin(Vue) {\r\n  Vue.prototype._update = function (vnode) {\r\n    const vm = this\r\n    patch(vm.$el, vnode)\r\n  }\r\n}\r\n\r\n/**\r\n * 挂载Vue组件\r\n * @param {object} vm - Vue 实例\r\n * @param {string} el - 挂载点\r\n */\r\nexport function mountComponent(vm, el) {\r\n  // 调用render方法去渲染 el 属性\r\n\r\n  // 先调用render 方法创建虚拟节点，再将虚拟节点渲染到页面上\r\n  vm._update(vm._render())\r\n}","import { initState } from './state'\r\nimport { compileToFunctions } from './compiler/index'\r\nimport { mountComponent } from './lifecycle'\r\n\r\n/**\r\n * Vue初始化功能扩展插件\r\n * @param {object} Vue - Vue构造函数\r\n */\r\nexport function initMixin(Vue) {\r\n  /**\r\n   * 初始化方法\r\n   * @param {object} options\r\n   */\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this\r\n    vm.$options = options\r\n\r\n    // 初始化状态(数据劫持，当数据改变时更新视图)\r\n    initState(vm)\r\n\r\n    // 如果当前有el属性说明要渲染模板\r\n    if (vm.$options.el) {\r\n      vm.$mount(vm.$options.el)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 挂载节点方法\r\n   * @param {string} params - 挂载点\r\n   */\r\n  Vue.prototype.$mount = function (el) {\r\n    const vm = this\r\n    const options = vm.$options\r\n    // 查询挂载节点\r\n    el = document.querySelector(el)\r\n    vm.$el = el\r\n\r\n    // 判断有没有render方法\r\n    if (!options.render) { // 无render\r\n      // 将template转换成render方法\r\n      let template = options.template\r\n      if (!template && el) { // 无template\r\n        // 使用挂载点作为模板\r\n        template = el.outerHTML\r\n      }\r\n      // 编译原理 将模板编译成render函数\r\n      const render = compileToFunctions(template)\r\n      options.render = render\r\n    }\r\n    // 有render(用户写的或者是使用模板编译出来的)\r\n\r\n    // 挂载组件\r\n    mountComponent(vm, el)\r\n\r\n  }\r\n}","/**\r\n * Vue渲染的扩展\r\n * @param {object} Vue - Vue 实例\r\n */\r\nexport function renderMixin(Vue) {\r\n  Vue.prototype._c = function () { // 创建虚拟dom元素\r\n    return createElement(...arguments)\r\n  }\r\n  Vue.prototype._s = function (val) { // 获取插值内容并转化为字符串\r\n    return val == null ? '' : (typeof val == 'object') ? JSON.stringify(val) : val\r\n  }\r\n  Vue.prototype._v = function (text) { // 创建虚拟dom文本元素\r\n    return createTextVnode(text)\r\n  }\r\n  Vue.prototype._render = function () { // _render = render\r\n    const vm = this\r\n    const render = vm.$options.render\r\n    let vnode = render.call(vm)\r\n\r\n    return vnode\r\n  }\r\n}\r\n\r\nfunction createElement(tag, data = {}, ...children) {\r\n  return vnode(tag, data, data.key, children)\r\n}\r\n\r\nfunction createTextVnode(text) {\r\n  return vnode(undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\n/**\r\n * 生成虚拟dom\r\n * @param {string} [ tag ] - 标签\r\n * @param {object} [ data ] - 标签属性对象\r\n * @param {string} [ key ] - 节点 key 值\r\n * @param {Array} [ children ] - 子节点\r\n * @param {string} [ text ] - 文本内容\r\n */\r\nfunction vnode(tag, data, key, children, text) {\r\n  return {\r\n    tag,\r\n    data,\r\n    key,\r\n    children,\r\n    text\r\n  }\r\n}","import { initMixin } from './init'\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport { renderMixin } from './vdom/index'\r\n\r\nfunction Vue(options) {\r\n  this._init(options)\r\n}\r\n\r\n// 扩展了初始化功能\r\ninitMixin(Vue)\r\n// 扩展了生命周期\r\nlifecycleMixin(Vue)\r\n// 扩展了Vue的渲染方法\r\nrenderMixin(Vue)\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","console","log","args","result","apply","inserted","ob","__ob__","slice","observeArray","proxy","vm","data","key","defineProperty","get","set","newValue","target","value","enumerable","configurable","defineReactive","observe","Observer","isArray","setPrototypeOf","walk","item","keys","initData","$options","_data","call","initState","opts","props","computed","watch","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tagName","attrs","tag","type","children","parent","root","currentParent","stack","start","element","push","end","pop","length","chars","text","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","str","i","obj","split","JSON","stringify","gen","node","generate","test","tokens","lastIndex","index","exec","trim","join","genChildren","el","map","child","code","compileToFunctions","template","ast","render","Function","patch","oldVnode","vnode","createElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","document","createElement","appendChild","createTextNode","lifecycleMixin","Vue","_update","$el","mountComponent","_render","initMixin","_init","options","$mount","querySelector","outerHTML","renderMixin","_c","arguments","_s","val","_v","createTextVnode","undefined"],"mappings":"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"}